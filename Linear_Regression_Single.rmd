---
title: "Linear Regression Single"
output: html_document
---
Nama: Ayat Tulloh Rahulloh Khomeini
NRP: 5026211156


The Data
```{r}
download.file("http://www.openintro.org/stat/data/mlb11.RData", destfile =
"mlb11.RData")
load("mlb11.RData")



```
1. Exercise 1:
   1. The best way to compare 2 variables is use Scatterplot, because each data point in the scatter plot represents a single observation, and the position of the point on the plot is determined by the values of the two variables, also Scatter plots can be used to show the strength, direction, and form of the relationship between two variables.
   2. good enough, but still many outlier
   3. will not be very comfortable using a linear model to predict the number of runs.
```{r}
library(ggplot2)
plot(mlb11$at_bats, mlb11$runs, type='p')
```
```{r}
cor(mlb11$runs, mlb11$at_bats)
```
SUM OF SQUARED RESIDUALS

2. Exercise 2:
The connection between runs scored and at-bats is positive but not extremely strong. This is due to the correlation coefficient of 0.610627, which is significantly less than 1. Additionally, there are a few obvious outliers in the data, such as a team with 5518 and 5600 at-bats.
```{r}
plot_ss(x = mlb11$at_bats, y = mlb11$runs,showSquares = TRUE)

```
3. Exercise 3:
i ran it for many severals, and the best sum of squares that i got is 123721.9
```{r}

```
THE LINEAR MODEL
```{r}
x <- mlb11$at_bats
y<-mlb11$runs
model<-lm(y~x)
summary(model)

```
4. Exercise 4:
A slope of 1.8345 indicates a strong positive correlation between two variables. This means that as one variable increases, the other variable tends to increase as well. in this context, homeruns affect the team's success in getting points
```{r}
x1<-mlb11$homeruns
y1<-mlb11$runs
model1<-lm(y1~x1)
summary(model1)
```
PREDICTION AND PREDICTION ERRORS
```{r}
x <- mlb11$at_bats
y<-mlb11$runs
plot(y~x)
abline(model)
```
5. Exercise 5:
Least Square Regression line for runs vs at_bats
y^ = -2789.2429 + 0.6305 * 5,578
y^ = 727.6861
we can estimate that a team with 5,578 at-bats would score approximately 728 runs. This is 15 runs more than the Philadelphia Phillies scored. This suggests that the model may have overestimated the number of runs for a team with 5,578 at-bats.
```{r}

```
MODEL DIAGNOSTICS
6. Exercise 6:
there is no apparent pattern in the distribution as the numbers appear to be scattered unevenly around the dashed line and appear to be skewed
```{r}
plot(model$residuals~mlb11$at_bats)
abline(h=0, lty=3)
```
```{r}
hist(model$residuals)

qqnorm(model$residuals)
qqline(model$residuals)
```
7. Exercise 7:
by the histogram and plot, we can conclude that nearly normal residuals condition has been met

8. Exercise 8:
The scatter of points around the regression line appears to be relatively consistent, suggesting that the assumption of homoscedasticity has been satisfied
----------------------------------------------------------------------------------------------------------------------------------------------------------------

On Your Own
```{r}
library(ggplot2)
#first step, looks and compare each variable
pairs(mlb11)
```
```{r}
x3<-mlb11$bat_avg
y3<-mlb11$runs
plot(y3~x3)
models<-lm(y3~x3)
abline(models)
```
```{r}
cor(y3,x3)
```
1.  y^ = -642 + 5242.2 * 0.8099859
y^ = 3604.10808498
linear and relatively strong
```{r}
summary(model)
```
```{r}
summary(models)
```
2. the R^2 at_bats is 0.3729 then avg_bats is 0.6561. by the R^2 value, model avg_bats more greater than model at_bats, so it is clear that the variable bat_avg predicts runs better than at bats
```{r}
x3<-mlb11$bat_avg
y3<-mlb11$runs
plot(y3~x3)
models<-lm(y3~x3)
abline(models)
```
```{r}
hist(models$residuals)
```
```{r}
qqnorm(models$residuals)
qqline(models$residuals)
```
```{r}
cor(y3,x3)
```
```{r}
summary(models)
```
3. It had a correlation coefficient of 0.8099859 which is a strong positive correlation. Also the R^2 value is 0.6561 which is also high

```{r}
cor(mlb11$runs, mlb11$new_onbase)
cor(mlb11$runs, mlb11$new_slug)
cor(mlb11$runs, mlb11$new_obs)

summary(lm(runs ~ new_onbase, data = mlb11))
summary(lm(runs ~ new_slug, data = mlb11))
summary(lm(runs ~ new_obs, data = mlb11))
```
```{r}
x3<-mlb11$bat_avg
y3<-mlb11$runs
plot(y3~x3)
models<-lm(y3~x3)
abline(models)
```
4. After examining the summary statistics and correlation coefficients of all three new predictors new_onbase, new_slug and new_obs, the relationship between runs and new_obs variable has the highest R2 and coefficient correlation values and appears to be the best and most effective predictor of the runs.
```{r}
model5<-lm(mlb11$runs ~ mlb11$new_onbase)
plot(model5$residuals ~ mlb11$bat_avg)
abline(h=0, lty=3)
```
```{r}
hist(model5$residuals)
qqnorm(model5$residuals)
qqline(model5$residuals)
```
5. 1) there is no direct pattern.
   2) the normal quantile-quantile plot of the residuals indicates a pretty straight line so we can safely say that the residuals are approximately normaly distributed and the model meets the nearly normal residuals condition
   3) the variability of points around the least squares line still constant = variability has been met
